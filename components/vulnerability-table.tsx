"use client"

interface Vulnerability {
  type: string
  severity: "HIGH" | "MEDIUM" | "LOW"
  pattern: string
  description: string
}

interface VulnerabilityTableProps {
  vulnerabilities: Vulnerability[]
}

export function VulnerabilityTable({ vulnerabilities }: VulnerabilityTableProps) {
  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case "HIGH":
        return "bg-red-100 text-red-800 border-red-200"
      case "MEDIUM":
        return "bg-orange-100 text-orange-800 border-orange-200"
      case "LOW":
        return "bg-green-100 text-green-800 border-green-200"
      default:
        return "bg-gray-100 text-gray-800 border-gray-200"
    }
  }

  const getSeverityText = (severity: string) => {
    switch (severity) {
      case "HIGH":
        return "높음"
      case "MEDIUM":
        return "중간"
      case "LOW":
        return "낮음"
      default:
        return severity
    }
  }

  if (vulnerabilities.length === 0) {
    return (
      <div className="text-center py-12">
        <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg className="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <h3 className="text-lg font-semibold text-gray-900 mb-2">취약점이 발견되지 않았습니다</h3>
        <p className="text-gray-600">웹사이트가 안전한 것으로 확인되었습니다.</p>
      </div>
    )
  }

  return (
    <div className="overflow-x-auto">
      <table className="w-full border-collapse">
        <thead>
          <tr className="bg-gray-50 border-b-2 border-gray-200">
            <th className="px-6 py-3 text-left text-sm font-semibold text-gray-900">취약점 유형</th>
            <th className="px-6 py-3 text-left text-sm font-semibold text-gray-900">심각도</th>
            <th className="px-6 py-3 text-left text-sm font-semibold text-gray-900">탐지된 패턴/위치</th>
            <th className="px-6 py-3 text-left text-sm font-semibold text-gray-900">상세 설명</th>
          </tr>
        </thead>
        <tbody>
          {vulnerabilities.map((vuln, index) => (
            <tr key={index} className="border-b border-gray-200 hover:bg-gray-50">
              <td className="px-6 py-4 text-sm font-medium text-gray-900">{vuln.type}</td>
              <td className="px-6 py-4">
                <span
                  className={`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${getSeverityColor(vuln.severity)}`}
                >
                  {getSeverityText(vuln.severity)}
                </span>
              </td>
              <td className="px-6 py-4 text-sm text-gray-700 font-mono text-xs">{vuln.pattern}</td>
              <td className="px-6 py-4 text-sm text-gray-600">{vuln.description}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}
